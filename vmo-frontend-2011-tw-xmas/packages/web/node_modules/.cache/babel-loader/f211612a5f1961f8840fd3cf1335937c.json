{"ast":null,"code":"import React from 'react';\nimport { now } from '@17media/dad';\nconst day = 1000 * 60 * 60 * 24;\nconst h = 1000 * 60 * 60;\nconst m = 1000 * 60;\n\nconst getRelatedDistance = dist => {\n  return {\n    d: Math.max(0, Math.floor(dist / day)),\n    h: Math.max(0, Math.floor(dist / h) % 24),\n    m: Math.max(0, Math.floor(dist / m) % 60),\n    s: Math.max(0, Math.floor(dist / 1000) % 60),\n    ms: Math.max(0, dist % 1000)\n  };\n};\n\nexport const useCountDown = endTime => {\n  let distance = endTime - now() * 1000;\n  const [count, setCount] = React.useState(distance);\n  let timer = 0;\n  const countDown = React.useCallback(() => {\n    distance = endTime - now() * 1000;\n    setCount(distance);\n\n    if (distance > 0) {\n      timer = requestAnimationFrame(countDown);\n    }\n  }, []);\n  React.useEffect(() => {\n    timer = requestAnimationFrame(countDown);\n    return () => {\n      cancelAnimationFrame(timer);\n    };\n  }, []);\n  return getRelatedDistance(count);\n};\nexport default useCountDown;","map":{"version":3,"sources":["D:\\17專案\\客製化ui專案\\test2\\vmo-frontend-2008-tw-momo\\packages\\ui\\hooks\\useCountDown.ts"],"names":["React","now","day","h","m","getRelatedDistance","dist","d","Math","max","floor","s","ms","useCountDown","endTime","distance","count","setCount","useState","timer","countDown","useCallback","requestAnimationFrame","useEffect","cancelAnimationFrame"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,GAAT,QAAoB,cAApB;AAEA,MAAMC,GAAG,GAAG,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAA7B;AACA,MAAMC,CAAC,GAAG,OAAO,EAAP,GAAY,EAAtB;AACA,MAAMC,CAAC,GAAG,OAAO,EAAjB;;AAEA,MAAMC,kBAAkB,GAAIC,IAAD,IAAkB;AAC3C,SAAO;AACLC,IAAAA,CAAC,EAAEC,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYD,IAAI,CAACE,KAAL,CAAWJ,IAAI,GAAGJ,GAAlB,CAAZ,CADE;AAELC,IAAAA,CAAC,EAAEK,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYD,IAAI,CAACE,KAAL,CAAWJ,IAAI,GAAGH,CAAlB,IAAuB,EAAnC,CAFE;AAGLC,IAAAA,CAAC,EAAEI,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYD,IAAI,CAACE,KAAL,CAAWJ,IAAI,GAAGF,CAAlB,IAAuB,EAAnC,CAHE;AAILO,IAAAA,CAAC,EAAEH,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYD,IAAI,CAACE,KAAL,CAAWJ,IAAI,GAAG,IAAlB,IAA0B,EAAtC,CAJE;AAKLM,IAAAA,EAAE,EAAEJ,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYH,IAAI,GAAG,IAAnB;AALC,GAAP;AAOD,CARD;;AAUA,OAAO,MAAMO,YAAY,GAAIC,OAAD,IAAqB;AAC/C,MAAIC,QAAQ,GAAGD,OAAO,GAAGb,GAAG,KAAK,IAAjC;AAEA,QAAM,CAACe,KAAD,EAAQC,QAAR,IAAoBjB,KAAK,CAACkB,QAAN,CAAeH,QAAf,CAA1B;AACA,MAAII,KAAK,GAAG,CAAZ;AAEA,QAAMC,SAAS,GAAGpB,KAAK,CAACqB,WAAN,CAAkB,MAAM;AACxCN,IAAAA,QAAQ,GAAGD,OAAO,GAAGb,GAAG,KAAK,IAA7B;AACAgB,IAAAA,QAAQ,CAACF,QAAD,CAAR;;AAEA,QAAIA,QAAQ,GAAG,CAAf,EAAkB;AAChBI,MAAAA,KAAK,GAAGG,qBAAqB,CAACF,SAAD,CAA7B;AACD;AACF,GAPiB,EAOf,EAPe,CAAlB;AASApB,EAAAA,KAAK,CAACuB,SAAN,CAAgB,MAAM;AACpBJ,IAAAA,KAAK,GAAGG,qBAAqB,CAACF,SAAD,CAA7B;AACA,WAAO,MAAM;AACXI,MAAAA,oBAAoB,CAACL,KAAD,CAApB;AACD,KAFD;AAGD,GALD,EAKG,EALH;AAOA,SAAOd,kBAAkB,CAACW,KAAD,CAAzB;AACD,CAvBM;AAyBP,eAAeH,YAAf","sourcesContent":["import React from 'react';\nimport { now } from '@17media/dad';\n\nconst day = 1000 * 60 * 60 * 24;\nconst h = 1000 * 60 * 60;\nconst m = 1000 * 60;\n\nconst getRelatedDistance = (dist: number) => {\n  return {\n    d: Math.max(0, Math.floor(dist / day)),\n    h: Math.max(0, Math.floor(dist / h) % 24),\n    m: Math.max(0, Math.floor(dist / m) % 60),\n    s: Math.max(0, Math.floor(dist / 1000) % 60),\n    ms: Math.max(0, dist % 1000),\n  };\n};\n\nexport const useCountDown = (endTime: number) => {\n  let distance = endTime - now() * 1000;\n\n  const [count, setCount] = React.useState(distance);\n  let timer = 0;\n\n  const countDown = React.useCallback(() => {\n    distance = endTime - now() * 1000;\n    setCount(distance);\n\n    if (distance > 0) {\n      timer = requestAnimationFrame(countDown);\n    }\n  }, []);\n\n  React.useEffect(() => {\n    timer = requestAnimationFrame(countDown);\n    return () => {\n      cancelAnimationFrame(timer);\n    };\n  }, []);\n\n  return getRelatedDistance(count);\n};\n\nexport default useCountDown;\n"]},"metadata":{},"sourceType":"module"}